
<!-- README.md is generated from README.Rmd. Please edit that file -->

# saeHB.twofold

<!-- badges: start -->

<!-- badges: end -->

Provides several functions for area and subarea level of small area
estimation under Twofold Subarea Level Model using hierarchical Bayesian
(HB) method with Univariate Normal distribution for variables of
interest. Some dataset simulated by a data generation are also provided.
The ‘rjags’ package is employed to obtain parameter estimates using
Gibbs Sampling algorithm. Model-based estimators involves the HB
estimators which include the mean, the variation of mean, and the
quantile. For the reference, see Rao and Molina (2015), Torabi (2014),
and Leyla Mohadjer et.al(2007)

## Author

Reyhan Saadi, Azka Ubaidillah

## Maintaner

Reyhan Saadi <221810557@stis.ac.id> or <aansum99@gmail.com>

## Function

  - `NormalTF()` This function gives estimation of subarea and area
    means simultaneously under Twofold Subarea Small Area Estimation
    Model Using Hierarchical Bayesian Method with Normal distribution
    based on model in Torabi (2014)

## Installation

You can install the development version of saeHB.twofold from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("reymath99/saeHB.twofold")
```

## Example

This is a basic example of using NormalTF function to make an estimate
based on sample data in this package

``` r
library(saeHB.twofold)
data(dataTwofold)
#for dataset with nonsampled subarea use dataTwofoldNS
#fitting model
model=NormalTF(y~x1+x2,vardir="vardir",area = "codearea",weight = "w",iter.mcmc = 10000,thin=4,burn.in = 1000,data=dataTwofold)
#> Compiling model graph
#>    Resolving undeclared variables
#>    Allocating nodes
#> Graph information:
#>    Observed stochastic nodes: 90
#>    Unobserved stochastic nodes: 125
#>    Total graph size: 864
#> 
#> Initializing model
#> 
#> Compiling model graph
#>    Resolving undeclared variables
#>    Allocating nodes
#> Graph information:
#>    Observed stochastic nodes: 90
#>    Unobserved stochastic nodes: 125
#>    Total graph size: 864
#> 
#> Initializing model
#> 
#> Compiling model graph
#>    Resolving undeclared variables
#>    Allocating nodes
#> Graph information:
#>    Observed stochastic nodes: 90
#>    Unobserved stochastic nodes: 125
#>    Total graph size: 864
#> 
#> Initializing model
```

Extract subarea mean estimation

``` r
model$Est_sub
#>                Mean       SD      2.5%       25%       50%       75%    97.5%
#> theta[1]   9.208023 2.126607  5.080387  7.750744  9.278760 10.642672 13.25681
#> theta[2]  13.502137 2.072983  9.506731 12.124084 13.481561 14.861806 17.54680
#> theta[3]  10.697300 2.079256  6.706356  9.288638 10.665538 12.107157 14.66236
#> theta[4]  11.634504 2.119311  7.511257 10.236495 11.657506 13.048458 15.73658
#> theta[5]  12.424699 2.114215  8.118401 11.090889 12.423789 13.846651 16.61556
#> theta[6]  13.511002 2.012017  9.672897 12.141891 13.522855 14.877052 17.48369
#> theta[7]  11.927238 2.116226  7.754017 10.551614 11.889899 13.363556 16.02231
#> theta[8]  13.861459 2.033003  9.823702 12.481304 13.875008 15.211186 17.89136
#> theta[9]  17.564542 2.135600 13.336711 16.111490 17.567103 18.989054 21.78565
#> theta[10] 11.717007 2.118713  7.730710 10.269224 11.675536 13.140634 15.96778
#> theta[11] 13.750772 2.137951  9.389244 12.360568 13.763640 15.210219 17.77741
#> theta[12]  8.722945 2.159217  4.592529  7.266023  8.699277 10.171941 12.89116
#> theta[13] 11.163381 2.154941  6.991332  9.701929 11.183935 12.601783 15.33923
#> theta[14] 10.825246 2.124691  6.764983  9.408879 10.830491 12.221408 14.96665
#> theta[15] 10.444678 2.094436  6.362890  9.059037 10.392781 11.807541 14.64788
#> theta[16] 15.530032 2.117147 11.217990 14.148343 15.513985 16.944375 19.50072
#> theta[17] 11.181134 2.085271  7.167070  9.805434 11.194974 12.591407 15.22375
#> theta[18]  6.961729 2.111766  2.718280  5.553760  7.010907  8.363168 11.08468
#> theta[19] 12.930580 2.102115  8.743494 11.554254 12.949902 14.378504 16.94123
#> theta[20] 11.210607 2.118879  7.001747  9.812316 11.216233 12.599679 15.32176
#> theta[21] 16.611503 2.134399 12.577181 15.171954 16.595199 18.047742 20.92898
#> theta[22] 16.410006 2.157198 12.292634 14.968161 16.371909 17.886995 20.79507
#> theta[23] 10.168502 2.131331  6.045163  8.749333 10.153309 11.627006 14.39800
#> theta[24] 15.195004 2.101946 10.968287 13.796479 15.180674 16.600390 19.09707
#> theta[25] 13.422277 2.110857  9.297827 11.954375 13.450789 14.850229 17.56655
#> theta[26] 12.236987 2.118748  8.246433 10.790852 12.208988 13.651177 16.50072
#> theta[27]  8.695403 2.093056  4.663272  7.206751  8.725951 10.133205 12.65803
#> theta[28] 13.463597 2.120915  9.426435 12.024741 13.517970 14.872393 17.66793
#> theta[29] 15.500418 2.173901 11.268003 14.077143 15.472493 16.915633 19.64286
#> theta[30] 11.291106 2.097039  7.220310  9.895000 11.334746 12.657735 15.34564
#> theta[31] 11.849021 2.132966  7.769760 10.427273 11.850470 13.291521 16.07364
#> theta[32]  7.569259 2.112830  3.451872  6.219425  7.539813  8.920911 11.73624
#> theta[33]  8.480724 2.145364  4.217457  7.032977  8.549176  9.914261 12.56197
#> theta[34] 15.002720 2.091327 10.968927 13.582617 14.993306 16.391700 18.98071
#> theta[35] 11.822873 2.179049  7.442989 10.398487 11.855466 13.310706 15.98962
#> theta[36] 12.688585 2.118843  8.542661 11.298706 12.653478 14.118044 16.82449
#> theta[37] 10.072956 2.024616  6.058703  8.743588 10.068991 11.373767 13.91117
#> theta[38] 10.356687 2.159876  6.141510  8.916557 10.306435 11.780360 14.59058
#> theta[39] 12.154483 2.154078  7.860951 10.695063 12.148034 13.579970 16.28088
#> theta[40]  9.017847 2.111437  4.822482  7.613386  9.045120 10.468236 13.03582
#> theta[41] 11.481755 2.041300  7.583254 10.053746 11.459745 12.951309 15.45247
#> theta[42] 14.705103 2.092471 10.665488 13.325911 14.708341 16.117972 18.79283
#> theta[43] 16.744330 2.148054 12.443814 15.292433 16.732027 18.194409 20.87657
#> theta[44] 13.147671 2.091383  9.244243 11.639344 13.089117 14.552499 17.37293
#> theta[45] 12.893044 2.111639  8.808325 11.479331 12.883280 14.273403 16.97681
#> theta[46] 10.063932 2.143780  5.937360  8.619591 10.048502 11.502299 14.19396
#> theta[47] 11.120526 2.117383  7.034238  9.677639 11.089304 12.552380 15.24186
#> theta[48]  9.926051 2.040829  6.020030  8.553860  9.933326 11.244622 13.98804
#> theta[49] 11.510002 2.097289  7.648387 10.104375 11.543309 12.940061 15.63274
#> theta[50] 12.366414 2.059788  8.261863 10.963719 12.344404 13.769931 16.35799
#> theta[51] 15.719244 2.145229 11.717594 14.231859 15.648286 17.224623 19.97737
#> theta[52] 13.807925 2.110286  9.633275 12.423301 13.809299 15.161821 18.02686
#> theta[53] 15.871946 2.111300 11.810062 14.409030 15.852937 17.274354 20.04687
#> theta[54] 12.998596 2.084024  8.882662 11.603839 13.001228 14.369006 17.25618
#> theta[55]  7.971022 2.078336  4.004795  6.554515  7.974145  9.416594 12.11493
#> theta[56]  8.946488 2.124739  4.830610  7.488041  9.003320 10.380789 13.06495
#> theta[57] 11.633344 2.137592  7.686079 10.132736 11.641931 13.129667 15.79647
#> theta[58] 12.624127 2.101139  8.394098 11.219305 12.608826 14.024894 16.59359
#> theta[59]  9.010957 2.134966  4.695598  7.592277  9.039590 10.426512 13.26292
#> theta[60] 13.616906 2.137638  9.366028 12.206879 13.617392 15.049380 17.86556
#> theta[61] 12.616927 2.144373  8.542968 11.111025 12.605880 14.078714 16.68637
#> theta[62] 13.188759 2.053937  9.215520 11.770620 13.181411 14.571805 17.14721
#> theta[63] 14.754258 2.128212 10.524788 13.305070 14.811844 16.222990 18.86655
#> theta[64] 13.381810 2.105435  9.195261 12.025840 13.425515 14.798114 17.49602
#> theta[65] 16.123633 2.073802 12.089834 14.724585 16.137654 17.449882 20.14857
#> theta[66] 15.749979 2.104191 11.636638 14.337550 15.739646 17.186565 19.91887
#> theta[67] 14.959097 2.129519 10.808111 13.569397 14.966792 16.305804 19.17556
#> theta[68]  8.895397 2.085259  4.770727  7.543136  8.959068 10.294722 12.89961
#> theta[69] 14.074700 2.074356  9.859189 12.753234 14.107356 15.432748 18.08804
#> theta[70] 11.400299 2.120034  7.315539  9.975149 11.390046 12.816360 15.70951
#> theta[71] 14.053768 2.110936  9.978828 12.618667 14.058537 15.459015 18.21579
#> theta[72]  7.827010 2.122139  3.529225  6.430483  7.818310  9.247515 11.89540
#> theta[73] 14.081212 2.167455  9.871064 12.651331 14.076235 15.514048 18.36000
#> theta[74] 15.847044 2.164784 11.733422 14.380185 15.793969 17.289820 20.17970
#> theta[75] 17.571367 2.145416 13.424830 16.120857 17.568346 19.009847 21.82503
#> theta[76] 11.050249 2.048853  7.026465  9.668436 11.073374 12.409457 14.96855
#> theta[77] 10.891792 2.129416  6.536383  9.444579 10.936915 12.308369 14.92330
#> theta[78] 12.572015 2.129838  8.500966 11.109745 12.599505 13.990776 16.80783
#> theta[79] 14.102242 2.083280 10.061840 12.742821 14.065873 15.467191 18.28129
#> theta[80] 11.725643 2.158904  7.488130 10.293442 11.750557 13.225539 15.90762
#> theta[81] 13.106147 2.097821  9.065871 11.631365 13.078820 14.530310 17.23644
#> theta[82]  9.375693 2.103885  5.123684  7.935759  9.474147 10.809182 13.33097
#> theta[83]  9.784999 2.107600  5.713059  8.345019  9.752241 11.288201 13.91280
#> theta[84]  8.832116 2.104830  4.613538  7.459796  8.857663 10.236178 12.91114
#> theta[85] 16.255533 2.123772 12.182936 14.742705 16.272432 17.693131 20.45841
#> theta[86] 18.274492 2.134343 14.104937 16.783806 18.277748 19.734406 22.34322
#> theta[87] 13.843448 2.111276  9.777822 12.451987 13.810280 15.217218 18.10951
#> theta[88]  9.873999 2.079157  5.810285  8.478768  9.878867 11.242960 13.87751
#> theta[89] 12.312430 2.071748  8.255625 10.882353 12.338369 13.701279 16.41247
#> theta[90] 11.886048 2.142766  7.761958 10.405273 11.843707 13.371170 15.98087
```

Extract area mean estimation

``` r
model$Est_area
#>         Mean       SD      2.5%       25%       50%      75%    97.5%
#> 1  10.706417 1.269873  8.020203  9.785836 10.711988 11.65778 13.33246
#> 2  12.631345 1.216777 10.179163 11.736751 12.626083 13.47450 15.11213
#> 3  13.897910 1.245008 11.220999 12.989416 13.893782 14.80028 16.54801
#> 4  11.754855 1.251900  9.056301 10.821370 11.748970 12.69694 14.53942
#> 5  10.844164 1.237734  8.228062  9.899275 10.844285 11.80631 13.47103
#> 6  11.424735 1.224123  8.721334 10.563863 11.436963 12.33018 13.94764
#> 7  13.403911 1.245757 10.813588 12.482968 13.358357 14.30340 16.08271
#> 8  14.195625 1.269633 11.614731 13.275931 14.179419 15.09417 16.93758
#> 9  11.347264 1.217902  8.791891 10.433996 11.349911 12.27417 13.90353
#> 10 13.046402 1.259907 10.306744 12.200755 13.039755 13.92229 15.69834
#> 11  9.593963 1.267637  6.690583  8.700041  9.649878 10.52018 12.22333
#> 12 13.223830 1.231687 10.594396 12.333055 13.225570 14.11522 15.87409
#> 13 10.987833 1.236767  8.276993 10.074503 10.966370 11.89852 13.63462
#> 14 11.722004 1.203564  9.070051 10.895365 11.745956 12.58570 14.15276
#> 15 14.558440 1.250786 11.960636 13.620004 14.528111 15.50142 17.22429
#> 16 10.426696 1.237703  7.821241  9.527178 10.390727 11.34226 13.18342
#> 17 13.364666 1.225248 10.812081 12.484983 13.374831 14.24631 15.95641
#> 18 14.046280 1.228506 11.484563 13.173168 14.065233 14.91472 16.72163
#> 19  9.984789 1.287131  7.270882  9.048386  9.971658 10.93443 12.71476
#> 20 11.939804 1.269798  9.184094 11.002259 11.958546 12.86424 14.49516
#> 21 13.575661 1.231775 10.946901 12.669193 13.557274 14.50171 16.21158
#> 22 14.919908 1.222780 12.389038 14.078307 14.873738 15.77962 17.59199
#> 23 12.669760 1.210989 10.111432 11.787326 12.678170 13.54822 15.24678
#> 24 11.345777 1.256556  8.746638 10.424480 11.361042 12.28058 13.92387
#> 25 15.815974 1.251912 13.081516 14.881655 15.806396 16.75893 18.65217
#> 26 11.429512 1.237987  8.773845 10.558393 11.423985 12.31479 13.99752
#> 27 12.851321 1.241444 10.153033 11.952023 12.858813 13.76958 15.45839
#> 28  9.373091 1.242601  6.459861  8.514679  9.395203 10.32779 12.05687
#> 29 16.252565 1.231771 13.641654 15.337605 16.259924 17.13968 18.99956
#> 30 11.385629 1.229688  8.755712 10.502272 11.395921 12.24786 13.92164
```

Extract coefficient estimation \(\beta\)

``` r
model$coefficient
#>                Mean         SD       2.5%        25%         50%       75%
#> beta[0]  0.53116332 0.59153231 -0.6510994  0.1331075  0.53860615 0.9469135
#> beta[1] -0.02281751 0.63862969 -1.2906202 -0.4485187 -0.02573815 0.4124443
#> beta[2]  1.19027986 0.06092845  1.0716750  1.1493186  1.18986596 1.2309239
#>            97.5%
#> beta[0] 1.649569
#> beta[1] 1.229830
#> beta[2] 1.314472
```

Extract estimation of subarea random effect variance \(\sigma^2_u\) and
area random effect variance \(\sigma^2_v\)

``` r
model$refvar
#>   var_area  var_sub
#> 1 2.204016 8.181486
```

Calculate relative standard error or CV

``` r
CV=(model$Est_sub$SD)/(model$Est_sub$Mean)*100
#cv summaries
summary(CV)
#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#>   11.68   14.92   17.01   17.81   19.61   30.33
```

## References

  - Mohadjer, L.K., Rao, J.N., Liu, B., Krenzke, T., & Kerckhove, W.V.
    (2007). Hierarchical Bayes Small Area Estimates of Adult Literacy
    Using Unmatched Sampling and Linking Models.
  - Torabi, M., & Rao, J.N. (2014). On small area estimation under a
    sub-area level model. J. Multivar. Anal., 127, 36-55.
  - Rao, J.N.K & Molina. (2015). Small Area Estimation 2nd Edition. New
    York: John Wiley and Sons, Inc.
